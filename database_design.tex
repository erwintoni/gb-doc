\Chapter{Database Design}

\section{Overview}
\subsection{MongoDB}
 MongoDB is a scalable, high-performance, open source, NoSQL document-based database. MongoDB features include document-oriented storage, indexes, replication, high availability, auto-sharding, and querying.  \cite{mongodb}

\subsection{MongoLab}
MongoLab is the cloud computing provider for MongoDB database that was used in this project \cite{mongolab}.  MongoLab has a free tier service that facilitates experimentation by developers, and thus was convenient for this project. 

\subsection{Documents}
Data in MongoDB is stored in documents, and every document must have a primary key named {\_id}. Like reqular SQL-based database, documents are like row in a table, where in MongoDB, documents have flexible schema, but every document must have {\_id} field, even if you don't speficy the {\_id} field, mongoDB will add that automatically.  \cite{mongodb}

Although document structure is not enforced in MongoDB, different data model and structure may have significant impacts on MongoDB and application performace. So it is good to keep some kind of structure or pattern in data model.  

\subsection{Collections}
Documents in MongoDB are organized in collection, and basic database operations are performed based on collection. Indexes can be assigned in any field or subfield contained in documents within a MongoDB collection, and they are defined on per-collection level.  \cite{mongodb}   

\section{Data Model}
In this project, there are three main collections, User, Group and Badge Colletion. And there are four linkings colletions to represent the many-to-many relationship between the main collections.

\begin{itemize}
\item user : this collection contains the user information
\item group : this collection contains the group information  
\item badge : this collection contains the badge information
\item group{\_}admin{\_}links : this linking collection contains group{\_}id and user{\_}id, which represent the admin of a group
\item group{\_}member{\_}links : this linking collection contains group{\_}id and user{\_}id, which represent the member of a group
\item badge{\_}user{\_}links : this linking colletion contains badge{\_}id and user{\_}id, which reperesnt badges that user earned
\item group{\_}badge{\_}links : think linking collection contains group{\_}id and badge{\_}id, which represent badges that belong to a group
\end{itemize}

\subsection{User Collection}
This collection contains of user documents, contain the following information, Table~\ref{table:UserCollection}

\begin{table}[H]
\caption{User Collection}
\label{table:UserCollection}
\textbf{ }
\begin{center}
\begin{tabular}{ | l | l |  l | }
\hline
Document Attribute & Sample Data & Description \\ \hline
{\_}id & 34728373 & Facebook user ID \\ \hline
last{\_}login & 12/1/13 12:34:56 PM & User last login timestamp   \\ \hline
\end{tabular}
\end{center}
\end{table}

\subsection{Group Collection}
This collection contains of group documents,  Table~\ref{table:GroupCollection}

\begin{table}[H]
\caption{Group Collection}\label{table:GroupCollection}
\textbf{ }
\begin{center}
\begin{tabular}{ | l | l |  l | }
\hline
Document Attribute & Sample Data & Description \\ \hline
{\_}id &  51466591b95b2b5023000001 & Auto-generated Group ID \\ \hline
name & Yoga CSUSB & Group name   \\ \hline
desc & This is Yoga group in CSUSB & Group description   \\ \hline
\end{tabular}
\end{center}
\end{table}


\subsection{Badge Collection}
This collection contains of badge documents,  Table~\ref{table:BadgeCollection}

\begin{table}[H]
\caption{Badge Collection}\label{table:BadgeCollection}
\textbf{ }
\begin{center}
\begin{tabular}{ | l | l |  l | }
\hline
Document Attribute & Sample Data & Description \\ \hline
{\_}id & 514e34507075ae0c0f000001 & Auto-generated Badge ID \\ \hline
name & Attended 10 classes & Badge name   \\ \hline
desc & This is badge description & Badge description   \\ \hline
pict & pict1.png & Badge Picture Reference   \\ \hline
\end{tabular}
\end{center}
\end{table}


\subsection{Group Admin Links Collection}
This collection represent many-to-many relationship between group and user. User in this collection means the admin of the group. Table~\ref{table:GroupAdminLinksCollection}

\begin{table}[H]
\caption{Group Admin Links Collection}\label{table:GroupAdminLinksCollection}
\textbf{ }
\begin{center}
\begin{tabular}{ | l | l |  l | }
\hline
Document Attribute & Sample Data & Description \\ \hline
{\_}id & 514e34507075ae0c0f000001 & Auto-generated Document ID \\ \hline
gid & 514e34507075ae0c0f000123 & Group ID   \\ \hline
uid & 514e34507075ae0c0f000456 & User ID as Admin   \\ \hline
\end{tabular}
\end{center}
\end{table}

\subsection{Group Member Links Collection}
This collection represent many-to-many relationship between group and user. User in this collection means the member of the group. Table~\ref{table:GroupMemberLinksCollection}

\begin{table}[H]
\caption{Group Member Links Collection}\label{table:GroupMemberLinksCollection}
\textbf{ }
\begin{center}
\begin{tabular}{ | l | l |  l | }
\hline
Document Attribute & Sample Data & Description \\ \hline
{\_}id & 514e34507075ae0c0f000002 & Auto-generated Document ID \\ \hline
gid & 514e34507075ae0c0f000123 & Group ID   \\ \hline
uid & 514e34507075ae0c0f000675 & User ID as Member   \\ \hline
\end{tabular}
\end{center}
\end{table}


\subsection{Badge User Links Collection}
This collection represent many-to-many relationship between badge and user. User in this collection means the user who earned the badge. Table~\ref{table:BadgeUserLinksCollection}

\begin{table}[H]
\caption{Badge User Links Collection}\label{table:BadgeUserLinksCollection}
\textbf{ }
\begin{center}
\begin{tabular}{ | l | l |  l | }
\hline
Document Attribute & Sample Data & Description \\ \hline
{\_}id & 514e34507075ae0c0f000005 & Auto-generated Document ID \\ \hline
bid & 514e34507075ae0c0f000975 & Badge ID   \\ \hline
uid & 514e34507075ae0c0f000456 & User ID as Earner   \\ \hline
\end{tabular}
\end{center}
\end{table}


\subsection{Group Badge Links Collection}
This collection represent many-to-many relationship between group and badge. Badge in this collection means the badge in the group. Table~\ref{table:GroupBadgeLinksCollection}

\begin{table}[H]
\caption{Group Badge Links Collection}\label{table:GroupBadgeLinksCollection}
\textbf{ }
\begin{center}
\begin{tabular}{ | l | l |  l | }
\hline
Document Attribute & Sample Data & Description \\ \hline
{\_}id & 514e34507075ae0c0f000004 & Auto-generated Document ID \\ \hline
gid & 514e34507075ae0c0f000158 & Group ID   \\ \hline
bid & 514e34507075ae0c0f000953 & Badge ID    \\ \hline
\end{tabular}
\end{center}
\end{table}


